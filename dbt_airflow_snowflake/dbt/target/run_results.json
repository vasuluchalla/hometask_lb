{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-11T18:48:39.505299Z", "invocation_id": "5c3cb453-e178-4449-ad8b-19da419ef461", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T18:48:35.093868Z", "completed_at": "2024-07-11T18:48:35.109733Z"}, {"name": "execute", "started_at": "2024-07-11T18:48:35.110379Z", "completed_at": "2024-07-11T18:48:35.705433Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.736548900604248, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b59a48-0202-d372-0002-d44600013e0e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_airflow_dbt.stg_contract", "compiled": true, "compiled_code": "\n\nWITH ranked_contracts AS (\n    SELECT\n        id::INTEGER AS id,\n        type::VARCHAR(50) AS type,\n        energy::VARCHAR(50) AS energy,\n        usage::FLOAT AS usage,\n        usagenet::FLOAT AS usagenet,\n        createdat::TIMESTAMP AS createdat,\n        startdate::DATE AS startdate,\n        enddate::DATE AS enddate,\n        city::VARCHAR(100) AS city,\n        status::VARCHAR(50) AS status,\n        productid::INTEGER AS productid,\n        modificationdate::TIMESTAMP AS modificationdate,\n        ROW_NUMBER() OVER (\n            PARTITION BY\n                id,\n                type,\n                energy,\n                usage,\n                usagenet,\n                createdat,\n                startdate,\n                enddate,\n                city,\n                status,\n                productid\n            ORDER BY\n                modificationdate DESC\n        ) AS row_num\n    FROM lb.raw.contract\n)\n\nSELECT\n    id,\n    type,\n    energy,\n    usage,\n    usagenet,\n    createdat,\n    startdate,\n    enddate,\n    city,\n    status,\n    productid,\n    modificationdate\nFROM ranked_contracts\nWHERE row_num = 1", "relation_name": "LB.stage.stg_contract"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T18:48:35.836565Z", "completed_at": "2024-07-11T18:48:35.842319Z"}, {"name": "execute", "started_at": "2024-07-11T18:48:35.842860Z", "completed_at": "2024-07-11T18:48:36.408361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.680974006652832, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b59a48-0202-d370-0002-d44600015c7a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_airflow_dbt.stg_prices", "compiled": true, "compiled_code": "\n\nWITH ranked_prices AS (\n    SELECT\n        id::INTEGER AS id,\n        productid::INTEGER AS productid,\n        pricecomponentid::INTEGER AS pricecomponentid,\n        productcomponent::VARCHAR(50) AS productcomponent,\n        price::FLOAT AS price,\n        unit::VARCHAR(20) AS unit,\n        modificationdate::TIMESTAMP AS modificationdate,\n        ROW_NUMBER() OVER (\n            PARTITION BY\n                id,\n                productid,\n                pricecomponentid,\n                productcomponent\n            ORDER BY\n                modificationdate DESC\n        ) AS row_num\n    FROM lb.raw.prices\n)\n\nSELECT\n    id,\n    productid,\n    pricecomponentid,\n    productcomponent,\n    price,\n    unit,\n    modificationdate\nFROM ranked_prices\nWHERE row_num = 1", "relation_name": "LB.stage.stg_prices"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T18:48:36.519847Z", "completed_at": "2024-07-11T18:48:36.523468Z"}, {"name": "execute", "started_at": "2024-07-11T18:48:36.523647Z", "completed_at": "2024-07-11T18:48:37.047549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6418969631195068, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b59a48-0202-d36d-0002-d44600011c9e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_airflow_dbt.stg_products", "compiled": true, "compiled_code": "\n\nWITH ranked_products AS (\n    SELECT\n        id::INTEGER AS productid,\n        productcode::VARCHAR(50) AS productcode,\n        productname::VARCHAR(100) AS productname,\n        energy::VARCHAR(50) AS energy,\n        consumptiontype::VARCHAR(50) AS consumptiontype,\n        deleted::BOOLEAN AS deleted,\n        modificationdate::TIMESTAMP AS modificationdate,\n        ROW_NUMBER() OVER (\n            PARTITION BY\n                id,\n                productcode,\n                productname,\n                energy,\n                consumptiontype\n            ORDER BY\n                modificationdate DESC\n        ) AS row_num\n    FROM lb.raw.products\n)\n\nSELECT\n    productid,\n    productcode,\n    productname,\n    energy,\n    consumptiontype,\n    deleted,\n    modificationdate\nFROM ranked_products\nWHERE row_num = 1", "relation_name": "LB.stage.stg_products"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T18:48:37.172926Z", "completed_at": "2024-07-11T18:48:37.178102Z"}, {"name": "execute", "started_at": "2024-07-11T18:48:37.178287Z", "completed_at": "2024-07-11T18:48:39.378601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.31665301322937, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b59a48-0202-d36c-0002-d44600014dbe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_airflow_dbt.fact_energy_revenue", "compiled": true, "compiled_code": "\n\nWITH latest_contracts AS (\n    SELECT\n        id AS contract_id,\n        type,\n        energy,\n        usage,\n        usagenet,\n        createdat,\n        startdate,\n        enddate,\n        city,\n        status,\n        productid,\n        modificationdate,\n        ROW_NUMBER() OVER (\n            PARTITION BY id\n            ORDER BY modificationdate DESC\n        ) AS row_num\n    FROM LB.stage.stg_contract\n),\nlatest_products AS (\n    SELECT\n        productid,\n        productcode,\n        productname,\n        energy,\n        modificationdate,\n        ROW_NUMBER() OVER (\n            PARTITION BY productid\n            ORDER BY modificationdate DESC\n        ) AS row_num\n    FROM LB.stage.stg_products\n),\nlatest_prices AS (\n    SELECT\n        productid,\n        MAX(CASE WHEN productcomponent = 'baseprice' THEN price ELSE NULL END) AS baseprice,\n        MAX(CASE WHEN productcomponent = 'workingprice' THEN price ELSE NULL END) AS workingprice\n    FROM LB.stage.stg_prices\n    GROUP BY productid\n)\n\nSELECT\n    c.contract_id,\n    c.type,\n    c.energy,\n    c.usage AS verbrauch,\n    c.usagenet,\n    c.createdat,\n    c.startdate,\n    c.enddate,\n    c.city,\n    c.status,\n    c.productid,\n    p.productcode,\n    p.productname,\n    lp.baseprice AS grundpreis,\n    lp.workingprice AS arbeitspreis,\n    (lp.baseprice + c.usage * lp.workingprice) AS revenue,\n    c.modificationdate\nFROM latest_contracts c\nLEFT JOIN latest_products p ON c.productid = p.productid\nLEFT JOIN latest_prices lp ON c.productid = lp.productid", "relation_name": "LB.stage.fact_energy_revenue"}], "elapsed_time": 6.019028186798096, "args": {"version_check": true, "log_format": "default", "printer_width": 80, "select": [], "indirect_selection": "eager", "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false, "introspect": true, "show_resource_report": false, "which": "run", "cache_selected_only": false, "exclude": [], "empty": false, "static_parser": true, "send_anonymous_usage_stats": true, "favor_state": false, "profiles_dir": "/Users/srinivasuluchalla/hometask_lb/dbt_airflow_snowflake/dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "print": true, "strict_mode": false, "log_format_file": "debug", "use_colors": true, "log_path": "/Users/srinivasuluchalla/hometask_lb/dbt_airflow_snowflake/dbt/logs", "full_refresh": true, "invocation_command": "dbt run --full-refresh", "log_level": "info", "defer": false, "use_colors_file": true, "log_level_file": "debug", "project_dir": "/Users/srinivasuluchalla/hometask_lb/dbt_airflow_snowflake/dbt", "enable_legacy_logger": false, "populate_cache": true, "partial_parse": true, "vars": {}, "macro_debugging": false, "partial_parse_file_diff": true, "quiet": false, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false}}